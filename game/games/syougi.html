<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>将棋盤 2人プレイ（上下攻め）</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f4f4f4;
    }

    .container {
      display: flex;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(9, 50px);
      grid-template-rows: repeat(9, 50px);
      gap: 1px;
      background-color: #333;
    }

    .square {
      width: 50px;
      height: 50px;
      background-color: #f0d899;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      position: relative;
    }

    .square:nth-child(odd) {
      background-color: #d19f6e;
    }

    /* 五角形の駒 */
    .piece {
      width: 40px;
      height: 40px;
      background-color: #ffcc00;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      font-weight: bold;
      clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
      cursor: pointer;
      transition: transform 0.3s ease;
      transform-origin: center;
    }

    /* プレイヤー1の駒は下向き */
    .piece[data-piece-owner="1"] {
      transform: rotate(180deg);
    }

    .piece.selected {
      border: 2px solid red;
    }

    .piece:hover {
      transform: scale(1.1);
    }

    .hands {
      margin-left: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .hand {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }

    .hand .piece {
      background-color: #ffcc00;
    }

    .turn-info {
      margin-bottom: 20px;
      font-size: 18px;
    }
  </style>
</head>
<body>

  <div class="container">
    <!-- ゲームのターン表示 -->
    <div class="turn-info" id="turnInfo">現在のターン: プレイヤー1</div>

    <div class="board">
      <!-- プレイヤー2の駒（上側） -->
      <div class="square" data-pos="0,0"><div class="piece" data-piece="香" data-piece-owner="2">香</div></div>
      <div class="square" data-pos="0,1"><div class="piece" data-piece="桂" data-piece-owner="2">桂</div></div>
      <div class="square" data-pos="0,2"><div class="piece" data-piece="銀" data-piece-owner="2">銀</div></div>
      <div class="square" data-pos="0,3"><div class="piece" data-piece="金" data-piece-owner="2">金</div></div>
      <div class="square" data-pos="0,4"><div class="piece" data-piece="王" data-piece-owner="2">王</div></div>
      <div class="square" data-pos="0,5"><div class="piece" data-piece="金" data-piece-owner="2">金</div></div>
      <div class="square" data-pos="0,6"><div class="piece" data-piece="銀" data-piece-owner="2">銀</div></div>
      <div class="square" data-pos="0,7"><div class="piece" data-piece="桂" data-piece-owner="2">桂</div></div>
      <div class="square" data-pos="0,8"><div class="piece" data-piece="香" data-piece-owner="2">香</div></div>

      <!-- プレイヤー1の駒（下側） -->
      <div class="square" data-pos="1,0"><div class="piece" data-piece="飛" data-piece-owner="1">飛</div></div>
      <div class="square" data-pos="1,1"><div class="piece" data-piece="角" data-piece-owner="1">角</div></div>
      <div class="square" data-pos="1,2"></div>
      <div class="square" data-pos="1,3"></div>
      <div class="square" data-pos="1,4"></div>
      <div class="square" data-pos="1,5"></div>
      <div class="square" data-pos="1,6"></div>
      <div class="square" data-pos="1,7"></div>
      <div class="square" data-pos="1,8"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>

      <!-- 中盤 -->
      <div class="square" data-pos="2,0"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,1"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,2"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,3"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,4"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,5"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,6"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,7"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>
      <div class="square" data-pos="2,8"><div class="piece" data-piece="歩" data-piece-owner="1">歩</div></div>

      <!-- 空きマス -->
      <div class="square" data-pos="3,0"></div>
      <div class="square" data-pos="3,1"></div>
      <div class="square" data-pos="3,2"></div>
      <div class="square" data-pos="3,3"></div>
      <div class="square" data-pos="3,4"></div>
      <div class="square" data-pos="3,5"></div>
      <div class="square" data-pos="3,6"></div>
      <div class="square" data-pos="3,7"></div>
      <div class="square" data-pos="3,8"></div>
    </div>

    <!-- 持ち駒エリア -->
    <div class="hands">
      <div><strong>持ち駒</strong></div>
      <div class="hand" id="player1Hands"></div>
      <div class="hand" id="player2Hands"></div>
    </div>
  </div>

  <script>
    let selectedPiece = null;
    let currentPlayer = 1;  // プレイヤー1からスタート
    const player1Hands = document.getElementById('player1Hands');
    const player2Hands = document.getElementById('player2Hands');
    const turnInfo = document.getElementById('turnInfo');

    // 駒を選択
    document.querySelectorAll('.piece').forEach(piece => {
      piece.addEventListener('click', function() {
        if (selectedPiece) {
          selectedPiece.classList.remove('selected');
        }
        selectedPiece = piece;
        piece.classList.add('selected');
      });
    });

    // 駒を移動
    document.querySelectorAll('.square').forEach(square => {
      square.addEventListener('click', function() {
        if (selectedPiece) {
          const pieceOwner = selectedPiece.dataset.pieceOwner;

          // 他プレイヤーの駒は動かせない
          if (pieceOwner !== String(currentPlayer)) {
            return;
          }

          const squareRow = parseInt(square.dataset.pos.split(',')[0]);
          const squareCol = parseInt(square.dataset.pos.split(',')[1]);

          // 駒の移動の制限（プレイヤー1は下から上、プレイヤー2は上から下）
          if (currentPlayer === 1 && squareRow <= 2) {
            return; // プレイヤー1は下から上へ進む
          } else if (currentPlayer === 2 && squareRow >= 7) {
            return; // プレイヤー2は上から下へ進む
          }

          // 駒が移動する場合、空いているマスに移動
          if (this.children.length === 0) {
            this.appendChild(selectedPiece);
            selectedPiece.classList.remove('selected');
            selectedPiece = null;

            // ターン交代
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updateTurn();
          }
        }
      });
    });

    // 駒を取る処理
    document.querySelectorAll('.square').forEach(square => {
      square.addEventListener('click', function() {
        if (this.children.length > 0 && this.children[0] !== selectedPiece) {
          const piece = this.children[0];
          const pieceOwner = piece.dataset.pieceOwner;

          // 駒を取る（取った駒は持ち駒エリアに追加）
          if (pieceOwner !== String(currentPlayer)) {
            takePiece(piece);
            this.removeChild(piece);
            selectedPiece = null;
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updateTurn();
          }
        }
      });
    });

    // 持ち駒エリアに駒を追加
    function takePiece(piece) {
      const pieceOwner = piece.dataset.pieceOwner;
      if (pieceOwner === '1') {
        player2Hands.appendChild(piece);  // プレイヤー2の持ち駒エリアに追加
      } else {
        player1Hands.appendChild(piece);  // プレイヤー1の持ち駒エリアに追加
      }
    }

    // 持ち駒を盤に戻す処理
    document.querySelectorAll('.hand').forEach(hand => {
      hand.addEventListener('click', function(event) {
        if (event.target.classList.contains('piece')) {
          const piece = event.target;
          const availableSquares = document.querySelectorAll('.square');

          // 空いているマスに持ち駒を配置
          availableSquares.forEach(square => {
            square.addEventListener('click', function() {
              if (this.children.length === 0) {
                this.appendChild(piece);
                selectedPiece = null;
                piece.dataset.pieceOwner = currentPlayer;
                currentPlayer = currentPlayer === 1 ? 2 : 1;
                updateTurn();
              }
            });
          });
        }
      });
    });

    // ターン表示の更新
    function updateTurn() {
      turnInfo.textContent = `現在のターン: プレイヤー${currentPlayer}`;
    }

  </script>
</body>
</html>
