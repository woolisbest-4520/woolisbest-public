<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç®—æ•°ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆ100å•ï¼‹ä¸€æ–‰æ¡ç‚¹ï¼‰</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f7f9fb;
      text-align: center;
      margin: 30px;
    }
    h1 {
      color: #333;
    }
    .problem {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      margin: 8px auto;
      width: 260px;
      box-shadow: 1px 1px 3px rgba(0,0,0,0.1);
      display: inline-block;
      vertical-align: top;
    }
    .question {
      font-size: 1.2rem;
      margin-bottom: 8px;
    }
    input[type="number"] {
      font-size: 1.1rem;
      width: 80px;
      text-align: center;
      padding: 4px;
      margin-bottom: 5px;
    }
    button {
      font-size: 0.9rem;
      padding: 4px 10px;
      margin-top: 5px;
      cursor: pointer;
    }
    .result {
      margin-top: 8px;
      font-weight: bold;
      height: 1.2em;
    }
    #moreButton, #resetButton, #checkAllButton {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #moreButton {
      background-color: #4CAF50;
      color: white;
    }
    #moreButton:hover {
      background-color: #45a049;
    }
    #resetButton {
      background-color: #007bff;
      color: white;
    }
    #resetButton:hover {
      background-color: #0069d9;
    }
    #checkAllButton {
      background-color: #ff9800;
      color: white;
    }
    #checkAllButton:hover {
      background-color: #e68900;
    }
    #score {
      font-size: 1.2rem;
      font-weight: bold;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <h1>ç®—æ•°ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
  <p>å„å•é¡Œã®ç­”ãˆã‚’å…¥åŠ›ã—ã¦ã€Œç­”ãˆåˆã‚ã›ã€ã‚’æŠ¼ã—ã¦ã­ï¼</p>

  <div id="problems"></div>

  <button id="moreButton" onclick="addMoreProblems()">ã‚ˆã‚Šå¤šãã®å•é¡Œã‚’è¡¨ç¤ºï¼ˆ+100å•ï¼‰</button>
  <br>
  <button id="checkAllButton" onclick="checkAll()">ğŸ§® å…¨éƒ¨ã¾ã¨ã‚ã¦ç­”ãˆåˆã‚ã›</button>
  <br>
  <button id="resetButton" onclick="resetProblems()">ğŸ”„ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
  <div id="score"></div>

  <script>
    let problems = [];
    let shownCount = 0;
    const batchSize = 100; // ä¸€åº¦ã«è¡¨ç¤ºã™ã‚‹å•é¡Œæ•°

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function createProblem() {
      let num1 = randomInt(1, 20);
      let num2 = randomInt(1, 20);
      const operators = ['+', '-', 'Ã—', 'Ã·'];
      const operator = operators[randomInt(0, operators.length - 1)];

      if (operator === 'Ã·') num1 = num1 * num2; // å‰²ã‚Šåˆ‡ã‚Œã‚‹ã‚ˆã†èª¿æ•´

      let correctAnswer;
      switch (operator) {
        case '+': correctAnswer = num1 + num2; break;
        case '-': correctAnswer = num1 - num2; break;
        case 'Ã—': correctAnswer = num1 * num2; break;
        case 'Ã·': correctAnswer = num1 / num2; break;
      }
      return { num1, num2, operator, correctAnswer };
    }

    function renderProblem(index, problem) {
      const div = document.createElement('div');
      div.className = 'problem';
      div.innerHTML = `
        <div class="question">${problem.num1} ${problem.operator} ${problem.num2} = ?</div>
        <input type="number" id="answer${index}" placeholder="ç­”ãˆ">
        <br>
        <button onclick="checkAnswer(${index})">ç­”ãˆåˆã‚ã›</button>
        <div class="result" id="result${index}"></div>
      `;
      return div;
    }

    function addMoreProblems() {
      const container = document.getElementById('problems');

      for (let i = shownCount; i < shownCount + batchSize; i++) {
        const p = createProblem();
        problems[i] = p;
        const div = renderProblem(i, p);
        container.appendChild(div);
      }

      shownCount += batchSize;
    }

    function checkAnswer(index) {
      const userAnswer = Number(document.getElementById(`answer${index}`).value);
      const resultDiv = document.getElementById(`result${index}`);
      const correct = problems[index].correctAnswer;

      if (isNaN(userAnswer)) {
        resultDiv.textContent = 'æ•°å­—ã‚’å…¥åŠ›ã—ã¦ã­ã€‚';
        resultDiv.style.color = 'red';
        return;
      }

      if (userAnswer === correct) {
        resultDiv.textContent = 'ğŸ‰ æ­£è§£ï¼';
        resultDiv.style.color = 'green';
      } else {
        resultDiv.textContent = `âŒ ä¸æ­£è§£ï¼ˆæ­£è§£ã¯ ${correct}ï¼‰`;
        resultDiv.style.color = 'red';
      }
    }

    function checkAll() {
      let correctCount = 0;
      for (let i = 0; i < shownCount; i++) {
        const answerBox = document.getElementById(`answer${i}`);
        if (!answerBox) continue;
        const userAnswer = Number(answerBox.value);
        const correct = problems[i].correctAnswer;
        const resultDiv = document.getElementById(`result${i}`);

        if (isNaN(userAnswer)) {
          resultDiv.textContent = 'æœªå…¥åŠ›';
          resultDiv.style.color = 'gray';
          continue;
        }

        if (userAnswer === correct) {
          resultDiv.textContent = 'ğŸ‰ æ­£è§£ï¼';
          resultDiv.style.color = 'green';
          correctCount++;
        } else {
          resultDiv.textContent = `âŒ (${correct})`;
          resultDiv.style.color = 'red';
        }
      }

      const scoreDiv = document.getElementById('score');
      scoreDiv.textContent = `âœ… æ­£è§£æ•°ï¼š${correctCount} / ${shownCount}`;
    }

    function resetProblems() {
      document.getElementById('problems').innerHTML = '';
      document.getElementById('score').textContent = '';
      problems = [];
      shownCount = 0;
      addMoreProblems();
    }

    // åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚ã«100å•ç”Ÿæˆ
    addMoreProblems();
  </script>
</body>
</html>
